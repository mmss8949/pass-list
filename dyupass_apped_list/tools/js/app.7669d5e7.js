(function(){"use strict";var t={7279:function(t,a,e){var s=e(144),o=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("v-app",[e("v-main",{staticClass:"pa-3"},[e("v-overlay",{attrs:{value:t.overlay}},[e("v-progress-circular",{attrs:{indeterminate:"",size:"64"}})],1),e("v-row",{staticClass:"mb-2",attrs:{"no-gutters":""}},[e("v-spacer"),e("v-btn",{attrs:{color:"primary",outlined:"",disabled:t.passData.button&&1==t.passData.button.restrict_btn.rules.disabled},on:{click:function(a){return t.newPass()}}},[t._v(" 新辦 ")])],1),t._l(t.passData,(function(a,s){return e("v-hover",{key:s,scopedSlots:t._u([{key:"default",fn:function(o){var n=o.hover;return[e("v-row",{staticClass:"row-border hover-bd-l-color py-lg-4 pr-lg-0 py-md-2 pr-md-0 py-5 pr-2 pl-2 mr-3",attrs:{"no-gutters":""}},[e("v-col",{attrs:{lg:"2",md:"2",cols:"4"}},[e("v-row",{attrs:{"no-gutters":""}},[e("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(a){var o=a.on,n=a.attrs;return[e("v-icon",t._g(t._b({staticStyle:{cursor:"pointer"},attrs:{size:"35",color:"black"},on:{click:function(){t.currentPassDataIndex=s,t.controllDialog(!0,1,"","")}}},"v-icon",n,!1),o),[t._v("mdi-information-outline ")])]}}],null,!0)},[e("span",[t._v("審核意見")])]),e("div",{staticClass:"d-flex ml-3 pa-0 pr-3",staticStyle:{"font-size":"25px","line-height":"40px"}},[t._v(" "+t._s(a.list_data.app_smye)+"-"+t._s(a.list_data.app_smty))])],1)],1),e("v-col",{attrs:{lg:"2",md:"2",cols:"12"}},[e("div",{style:{"font-size":"30px","line-height":"40px","font-weight":n?"bold":"normal"}},[t._v(" "+t._s(a.list_data.plate_number)+" ")])]),e("v-col",{attrs:{lg:"2",md:"2",cols:"4"}},[e("div",{staticClass:"d-flex pa-0 pr-3",staticStyle:{"font-size":"23px","line-height":"40px"}},[t._v(" "+t._s(t.changePassTypeToString(a.list_data.app_pass_type)))])]),e("v-col",{attrs:{lg:"1",md:"1",cols:"4"}},[e("div",{staticClass:"d-flex pa-0 pr-3",staticStyle:{"font-size":"23px","line-height":"40px"}},[t._v(" "+t._s(t.changeStatusToString(a.list_data.todo_flag)))])]),e("v-col",{attrs:{lg:"3",md:"3",cols:"12"}},[0!=a.list_data.todo_date.length?e("div",{staticClass:"d-flex pa-0 pr-3 txt-overflow",staticStyle:{"font-size":"20px","line-height":"40px"}},[e("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(s){var o=s.on,n=s.attrs;return[e("span",t._g(t._b({staticClass:"txt-overflow"},"span",n,!1),o),[t._v(" "+t._s(t.changeTodoFlagString(a.list_data)))])]}}],null,!0)},[e("span",[t._v(" "+t._s(t.changeTodoFlagString(a.list_data)))])])],1):t._e()]),e("v-col",{staticClass:"d-flex justify-end pr-2",attrs:{lg:"2",md:"2",cols:"12"}},t._l(a.button,(function(o,r){return e("div",{key:o.type},["del_button"==o.type?e("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(i){var l=i.on,c=i.attrs;return[e("v-icon",t._g(t._b({class:{"mr-7":r+1!=a.button.length},style:1==o.rules.disabled?"cursor:not-allowed":"cursor:pointer",attrs:{size:"35",color:n?1==o.rules.disabled?"grey":"black":"grey"},on:{click:function(a){1==o.rules.disabled||t.deleteDialog(s)}}},"v-icon",c,!1),l),[t._v("mdi-delete-outline ")])]}}],null,!0)},[e("span",[t._v(t._s(1==o.rules.disabled?t.changeDBMToString(o.rules.delete_button_msg):o.value))])]):"pay_button"==o.type?e("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(i){var l=i.on,c=i.attrs;return[e("v-icon",t._g(t._b({class:{"mr-7":r+1!=a.button.length},style:1==o.rules.disabled?"cursor:not-allowed":"cursor:pointer",attrs:{size:"35",color:n?1==o.rules.disabled?"grey":"black":"grey"},on:{click:function(e){1==o.rules.disabled||t.payDialog(s,a,o)}}},"v-icon",c,!1),l),[t._v("mdi-cash ")])]}}],null,!0)},[e("span",[t._v(t._s(1==o.rules.disabled?t.changePBMToString(o.rules.payment_button_msg):o.value))])]):"reapp_button"==o.type?e("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(i){var l=i.on,c=i.attrs;return[e("v-icon",t._g(t._b({class:{"mr-7":r+1!=a.button.length},style:1==o.rules.disabled?"cursor:not-allowed":"cursor:pointer",attrs:{size:"35",color:n?1==o.rules.disabled?"grey":"black":"grey"},on:{click:function(e){1==o.rules.disabled||t.renewPass(s,a)}}},"v-icon",c,!1),l),[t._v("mdi-clipboard-check-outline ")])]}}],null,!0)},[e("span",[t._v(t._s(1==o.rules.disabled?t.changeRBMToString(o.rules.reapp_button_msg):o.value))])]):t._e()],1)})),0)],1)]}}],null,!0)})})),t.getFirstDataState&&0==t.passData.length?e("v-alert",{attrs:{type:"info",text:""}},[t._v(" 無資料 ")]):t._e(),e("v-dialog",{attrs:{"max-width":"600"},model:{value:t.dialog.show,callback:function(a){t.$set(t.dialog,"show",a)},expression:"dialog.show"}},[0==t.dialog.index?e("v-card",[e("v-card-title",{staticClass:"text-h5"},[t._v(" "+t._s(t.dialog.title)+" ")]),e("v-card-text",{staticClass:"text-h6"},[t._v(" "+t._s(t.dialog.msg)+" ")]),e("v-card-actions",[e("v-spacer"),e("v-btn",{attrs:{color:"primary",text:""},on:{click:function(a){t.dialog.show=!1}}},[t._v(" close ")])],1)],1):1==t.dialog.index?e("v-card",[e("v-card-title",{staticClass:"text-h5"},[t._v(" 審核意見 ")]),e("v-card-text",[t._l(t.passData[t.currentPassDataIndex].list_data.check_reason,(function(a){return e("v-row",{key:a.sno,staticClass:"py-2",attrs:{"no-gutters":""}},[e("v-row",{staticClass:"mb-1",staticStyle:{"font-size":"18px","font-weight":"400"},attrs:{"no-gutters":""}},[t._v(t._s(a.check_reason))]),e("v-row",{attrs:{"no-gutters":""}},[e("v-col",{staticClass:"d-flex justify-end",staticStyle:{"font-size":"14px",color:"grey"},attrs:{cols:"12"}},[t._v(" "+t._s(a.contact_info))]),e("v-col",{staticClass:"d-flex justify-end",staticStyle:{"font-size":"14px",color:"grey"},attrs:{cols:"12"}},[t._v(" "+t._s(a.check_date))])],1)],1)})),t.passData[t.currentPassDataIndex]&&0==t.passData[t.currentPassDataIndex].list_data.check_reason.length?e("v-row",{attrs:{"no-gutters":""}},[e("v-col",{attrs:{cols:"12"}},[e("v-alert",{attrs:{type:"info",text:""}},[t._v(" 無資料 ")])],1)],1):t._e()],2),e("v-card-actions",[e("v-row",{attrs:{"no-gutters":""}},[e("v-spacer"),e("v-btn",{attrs:{color:"primary",text:""},on:{click:function(a){return t.controllDialog(!1,0,"","")}}},[t._v(" close ")])],1)],1)],1):2==t.dialog.index?e("v-card",[e("v-card-title",{staticClass:"text-h5"},[t._v(" 確定刪除? ")]),e("v-card-text"),e("v-card-actions",[e("v-row",{attrs:{"no-gutters":""}},[e("v-spacer"),e("v-btn",{attrs:{color:"error",text:""},on:{click:function(a){return t.controllDialog(!1,0,"","")}}},[t._v(" no ")]),e("v-btn",{attrs:{color:"primary",text:""},on:{click:function(a){return t.deleteItem()}}},[t._v(" yes ")])],1)],1)],1):3==t.dialog.index?e("v-card",[e("v-card-title",{staticClass:"text-h5"},[t._v(" 繳費詳細資料 ")]),e("v-card-text",[e("v-form",{attrs:{readonly:""}},[e("v-text-field",{attrs:{label:"學年",outlined:""},model:{value:t.dialog.form.app_smye,callback:function(a){t.$set(t.dialog.form,"app_smye",a)},expression:"dialog.form.app_smye"}}),e("v-text-field",{attrs:{label:"學期",outlined:""},model:{value:t.dialog.form.app_smty,callback:function(a){t.$set(t.dialog.form,"app_smty",a)},expression:"dialog.form.app_smty"}}),e("v-text-field",{attrs:{label:"車牌號碼",outlined:""},model:{value:t.dialog.form.plate_number,callback:function(a){t.$set(t.dialog.form,"plate_number",a)},expression:"dialog.form.plate_number"}}),e("v-select",{attrs:{items:t.info.app_pass_type,"item-text":"code_value","item-value":"code_no",label:"類別",outlined:""},model:{value:t.dialog.form.app_pass_type,callback:function(a){t.$set(t.dialog.form,"app_pass_type",a)},expression:"dialog.form.app_pass_type"}})],1),e("v-alert",{attrs:{text:"",type:"info",icon:"mdi-currency-usd "}},[t._v(" "+t._s(t.dialog.form.title)+" ")]),e("v-alert",{attrs:{text:"",type:"warning"}},[t._v(" PDF將會開啟另一視窗產生 ")])],1),e("v-card-actions",[e("v-row",{attrs:{"no-gutters":""}},[e("v-spacer"),e("v-btn",{attrs:{color:"error",text:""},on:{click:function(a){return t.controllDialog(!1,0,"","")}}},[t._v(" 不同意 ")]),e("v-btn",{attrs:{color:"primary",text:""},on:{click:function(a){return t.exportPDF()}}},[t._v(" 同意 ")])],1)],1)],1):t._e()],1)],2)],1)},n=[],r=(e(1703),e(9669)),i=e.n(r),l={name:"App",components:{},data:()=>({testMode:!1,target:`gGroups_i=${gGroups}&gSys_s=${gSys_s}&gFunc_s=${gFunc_s}`,themeColor:"",overlay:!1,getFirstDataState:!1,step:1,valid:!0,passData:[],currentPassDataIndex:0,info:{app_pass_type:[],vr_data:[],vehicle_category:[],todo_flag:[],violation_msg:[],alert_msg:[],driver_license_pass_msg:[],delete_button_msg:[],payment_button_msg:[],reapp_button_msg:[]},dialog:{index:0,show:!1,title:"",msg:"",form:{app_no:"",app_smye:0,app_smty:0,app_pass_type:"",plate_number:"",title:"",price:"",app_identity:""}}}),created(){const t=this;-1!=location.href.indexOf("localhost")||-1!=location.href.indexOf("github")?t.testMode=!0:t.testMode=!1},mounted(){const t=this;var a=()=>{var a=function(t){var a;switch(t){case"blue":a="#3b5998";break;case"green":a="#098c6e";break;case"red":a="#b72e4a";break;case"highway":a="#c60";break;case"violet":a="#8b00ff";break}return a};window.localStorage.getItem("_client_color")?t.themeColor=a(window.localStorage.getItem("_client_color")):t.themeColor=a(window.localStorage.getItem("_default_color"))};a(),window.addEventListener("storage",(()=>{a()})),t.mainProcess()},updated(){const t=this;t.updateHeight()},computed:{years:function(){const t=this;var a=[],e=Date.now();if(t.passData.vehicle_license_list&&0!=t.passData.vehicle_license_list.length){var s=t.passData.vehicle_license_list[t.currentPassDataIndex].app_restrictions;s.rules.forEach((t=>{var s=Date.parse(t.canapp_date_b),o=Date.parse(t.canapp_date_e);s<=e&&o>=e&&a.push(t)}))}return a},passes:function(){const t=this;var a=[],e=Date.now();return t.passData.vehicle_license_list&&0!=t.passData.vehicle_license_list.length&&0!=t.form.app_smye.length&&t.years.forEach((s=>{var o=Date.parse(s.canapp_date_b),n=Date.parse(s.canapp_date_e);if(o<=e&&n>=e&&s.canapp_smye==t.form.app_smye){var r={};r.value=s.canapp_pass_type;var i=t.changePassTypeToString(s.canapp_pass_type);r.text=i.code_value,a.push(r)}})),a}},methods:{mainProcess:async function(){const t=this;try{var a;t.overlay=!0,a=await t.getPassInfo(),t.setPassInfo(a),t.passData=await t.getPassData(),t.getFirstDataState=!0,t.overlay=!1}catch(e){throw new Error(e)}},controllDialog:function(t,a,e,s){const o=this;o.dialog.show=t,o.dialog.index=a,o.dialog.title=e,o.dialog.msg=s},setForm:function(t,a){const e=this;var s=e.dialog.form;s.app_no=t.list_data.app_no,s.app_smye=t.list_data.app_smye,s.app_smty=t.list_data.app_smty,s.app_pass_type=t.list_data.app_pass_type,s.plate_number=t.list_data.plate_number,s.app_identity=t.list_data.app_identity,s.title=a.payment_form.title,s.price=a.payment_form.price},payDialog:function(t,a,e){const s=this;s.currentPassDataIndex=t,s.setForm(a,e),s.controllDialog(!0,3,"","")},deleteDialog:function(t){const a=this;a.currentPassDataIndex=t,a.controllDialog(!0,2,"","")},changeCategoryToString:function(t){const a=this;var e,s="";return e=a.info.vehicle_category.findIndex((a=>a.code_no==parseInt(t))),s=a.info.vehicle_category[e].code_value,s},changePassTypeToString:function(t){const a=this;var e="";return e=a.info.app_pass_type.find((a=>t==a.code_no)),e.code_value},changeStatusToString:function(t){const a=this;var e="";return e=a.info.todo_flag.find((a=>t==a.code_no)),e.code_value},changeDBMToString:function(t){const a=this;var e="";return e=a.info.delete_button_msg.find((a=>t==a.code_no)),e.code_value},changePBMToString:function(t){const a=this;var e="";return e=a.info.payment_button_msg.find((a=>t==a.code_no)),e.code_value},changeRBMToString:function(t){const a=this;var e="";return e=a.info.reapp_button_msg.find((a=>t==a.code_no)),e.code_value},changeTodoFlagString:function(t){var a="";switch(parseInt(t.todo_flag)){case 0:a="申請日期  "+t.app_date;break;case 1:a="2"==t.app_identity?0!=t.payment_start_date.length&&0!=t.payment_end_date.length?"繳費期間  "+t.payment_start_date+" ~ "+t.payment_end_date:"非繳費期間":"即日起可繳費";break;case 5:a="審核日期  "+t.todo_date;break;case 9:a="已繳費日期  "+t.pay_date;break}return a},deleteItem:function(){const t=this;var a={app_no:t.passData[t.currentPassDataIndex].list_data.app_no};t.testMode?console.log(a):t.postPassData(0,a)},exportPDF:function(){const t=this;var a={app_no:t.dialog.form.app_no,app_smye:t.dialog.form.app_smye,app_smty:t.dialog.form.app_smty,plate_number:t.dialog.form.plate_number,app_pass_type:t.dialog.form.app_pass_type,app_identity:t.dialog.form.app_identity,price:t.dialog.form.price};t.testMode?console.log(a):t.postPassData(1,a)},renewPass:function(t,a){const e=this;e.currentPassDataIndex=t;var s=a.list_data.plate_number,o="./dyupass_app.php?"+e.target+"&plate_number="+s;-1!=location.href.indexOf("github")?location.href="https://mmss8949.github.io/apply-pass/index.html?plate_number="+s:e.testMode?console.log(o):location.href=o},newPass:function(){const t=this;var a="./dyupass_app.php?"+t.target;t.testMode?location.href="https://mmss8949.github.io/apply-pass":location.href=a},getPassData:function(){const t=this;return new Promise(((a,e)=>{t.testMode?i().get("./dyupass_apped_list/tools/json/testData.json?"+Math.random()).then((t=>{a(t.data.data)})).catch((t=>{parent.sysDisplayMessage("",-1,"","",null,"取得資訊失敗:-102"),e(t)})):i().get("../kernel/dyupass_apped_list_oci.php?"+t.target).then((t=>{a(t.data.data)})).catch((t=>{parent.sysDisplayMessage("",-1,"","",null,"取得資訊失敗:-102"),e(t)}))}))},postPassData:function(t,a){const e=this;switch(e.overlay=!0,t){case 0:i().post("../kernel/dyupass_apped_list_save.php?"+e.target,a).then((async t=>{1==t.data.result?(parent.sysDisplayMessage("",0,"","",null,"刪除成功"),e.passData=await e.getPassData(),e.controllDialog(!1,0,"","")):parent.sysDisplayMessage("",-1,"","",null,"刪除失敗: "+t.data.msg),e.overlay=!1})).catch((t=>console.log(t)));break;case 1:i().post("../kernel/dyupass_payfee.php?"+e.target,a).then((async t=>{1==t.data.result?(window.open(t.data.data),e.controllDialog(!1,0,"","")):parent.sysDisplayMessage("",-1,"","",null,t.data.msg),e.overlay=!1})).catch((t=>console.log(t)));break}},getPassInfo:function(){const t=this;return new Promise(((a,e)=>{t.testMode?i().get("./dyupass_apped_list/tools/json/dyupass_tw.json?"+Math.random()).then((t=>{a(t.data)})).catch((t=>{parent.sysDisplayMessage("",-1,"","",null,"取得資訊失敗:-101"),e(t)})):i().get("../json/tw/dyupass_tw.json?"+Math.random()).then((t=>{a(t.data)})).catch((t=>{parent.sysDisplayMessage("",-1,"","",null,"取得資訊失敗:-101"),e(t)}))}))},setPassInfo:function(t){const a=this;a.info.app_pass_type=t.app_pass_type,a.info.vr_data=t.vr_data,a.info.vehicle_category=t.vehicle_category,a.info.todo_flag=t.todo_flag,a.info.pay_flag=t.pay_flag,a.info.violation_msg=t.violation_msg,a.info.alert_msg=t.alert_msg,a.info.driver_license_pass_msg=t.driver_license_pass_msg,a.info.delete_button_msg=t.delete_button_msg,a.info.payment_button_msg=t.payment_button_msg,a.info.reapp_button_msg=t.reapp_button_msg},updateHeight:function(){const t=this;t.$nextTick((()=>{setTimeout((()=>{if(document.getElementById("app").scrollHeight>900){var t=document.body.scrollHeight+1;window.parent.postMessage('{"event": "changeHeight", "value": '+t+"}","*")}}),1e3)}))}}},c=l,p=e(1001),d=e(3453),_=e.n(d),u=e(9602),g=e(303),v=e(9787),f=e(2026),m=e(5255),y=e(7024),h=e(9257),b=e(3240),x=e(9657),w=e(4456),D=e(927),k=e(8913),S=e(3297),P=e(7894),C=e(4081),M=e(6946),T=e(2660),I=e(127),Z=(0,p.Z)(c,o,n,!1,null,"4355d98e",null),V=Z.exports;_()(Z,{VAlert:u.Z,VApp:g.Z,VBtn:v.Z,VCard:f.Z,VCardActions:m.h7,VCardText:m.ZB,VCardTitle:m.EB,VCol:y.Z,VDialog:h.Z,VForm:b.Z,VHover:x.Z,VIcon:w.Z,VMain:D.Z,VOverlay:k.Z,VProgressCircular:S.Z,VRow:P.Z,VSelect:C.Z,VSpacer:M.Z,VTextField:T.Z,VTooltip:I.Z});var j=e(5121);s.Z.use(j.Z);var O=new j.Z({});s.Z.config.productionTip=!1,new s.Z({vuetify:O,render:t=>t(V)}).$mount("#app")}},a={};function e(s){var o=a[s];if(void 0!==o)return o.exports;var n=a[s]={exports:{}};return t[s](n,n.exports,e),n.exports}e.m=t,function(){var t=[];e.O=function(a,s,o,n){if(!s){var r=1/0;for(p=0;p<t.length;p++){s=t[p][0],o=t[p][1],n=t[p][2];for(var i=!0,l=0;l<s.length;l++)(!1&n||r>=n)&&Object.keys(e.O).every((function(t){return e.O[t](s[l])}))?s.splice(l--,1):(i=!1,n<r&&(r=n));if(i){t.splice(p--,1);var c=o();void 0!==c&&(a=c)}}return a}n=n||0;for(var p=t.length;p>0&&t[p-1][2]>n;p--)t[p]=t[p-1];t[p]=[s,o,n]}}(),function(){e.n=function(t){var a=t&&t.__esModule?function(){return t["default"]}:function(){return t};return e.d(a,{a:a}),a}}(),function(){e.d=function(t,a){for(var s in a)e.o(a,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:a[s]})}}(),function(){e.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){e.o=function(t,a){return Object.prototype.hasOwnProperty.call(t,a)}}(),function(){e.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){var t={143:0};e.O.j=function(a){return 0===t[a]};var a=function(a,s){var o,n,r=s[0],i=s[1],l=s[2],c=0;if(r.some((function(a){return 0!==t[a]}))){for(o in i)e.o(i,o)&&(e.m[o]=i[o]);if(l)var p=l(e)}for(a&&a(s);c<r.length;c++)n=r[c],e.o(t,n)&&t[n]&&t[n][0](),t[n]=0;return e.O(p)},s=self["webpackChunkdyupass_apped_list"]=self["webpackChunkdyupass_apped_list"]||[];s.forEach(a.bind(null,0)),s.push=a.bind(null,s.push.bind(s))}();var s=e.O(void 0,[998],(function(){return e(7279)}));s=e.O(s)})();
//# sourceMappingURL=app.7669d5e7.js.map